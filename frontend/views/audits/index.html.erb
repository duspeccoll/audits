<%= setup_context :title => I18n.t("plugins.audits.title") %>

<div class="row">
	<div class="col-md-12">
		<h2><%= I18n.t("plugins.audits.title") %></h2>

		<%= render_aspace_partial :partial => "shared/flash_messages" %>

		<div id="audit_results"></div>

		<div id="audit_select">
			<%= form_tag({:controller => :audits, :action => :run}, {:id => "audit_form", :class => "form-select", :method => "GET"}) do |form| %>

				<button type="submit" id="audit-select" class="btn btn-primary">
					<%= I18n.t("plugins.audits.actions.run") %>
				</button>

			<% end %>
		</div>
	</div>
</div>

<script src="<%= "#{AppConfig[:frontend_prefix]}assets/audits.js" %>"></script>
<link href="<%= "#{AppConfig[:frontend_prefix]}assets/styles/audits.css" %>" media="all" rel="stylesheet" type="text/css"></link>

<div id="audit_result"><!--
	<table id="audit-result" class="table table-striped table-bordered table-sortable">
		<thead>
			<tr>
				<td>ID</td>
				<td>Title</td>
				<td>Date?</td>
				<td>Extent?</td>
				<td>Abstract?</td>
				<td>Agents</td>
				<td>Subjects</td>
			</tr>
		</thead>
		{for row in rows}
		<tr>
			<td>${row.call_number}</td>
			<td><a href="/resources/${row.id}">${row.title}</a></td>
			{if row.date}
				<td class="audit-success"><span class="glyphicon glyphicon-plus"></span></td>
			{else}
				<td class="audit-warning"><span class="glyphicon glyphicon-exclamation-sign"></span></td>
			{/if}
			{if row.extent}
				<td class="audit-success"><span class="glyphicon glyphicon-plus"></span></td>
			{else}
				<td class="audit-failure"><span class="glyphicon glyphicon-remove"></span></td>
			{/if}
			{if row.abstract}
				<td class="audit-success"><span class="glyphicon glyphicon-plus"></span></td>
			{else}
				<td class="audit-failure"><span class="glyphicon glyphicon-remove"></span></td>
			{/if}
			{if row.agents == 0}
				<td class="audit-failure">${row.agents}</td>
			{else}
				<td class="audit-success">${row.agents}</td>
			{/if}
			{if row.subjects < 2}
				<td class="audit-failure">${row.subjects}</td>
			{else}
				<td class="audit-success">${row.subjects}</td>
			{/if}
		</tr>
		{/for}
	</table>
--></div>

<div id="audit_loading"><!--
	<center>
		<div class="alert alert-info"><%= I18n.t("plugins.audits.actions.loading") %></div>
	</center>
--></div>
